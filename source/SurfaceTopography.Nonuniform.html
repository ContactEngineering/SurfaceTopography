

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>SurfaceTopography.Nonuniform package &mdash; SurfaceTopography 0.93.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SurfaceTopography.Uniform package" href="SurfaceTopography.Uniform.html" />
    <link rel="prev" title="SurfaceTopography.IO package" href="SurfaceTopography.IO.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SurfaceTopography
          

          
          </a>

          
            
            
              <div class="version">
                0.93.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to SurfaceTopography</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="SurfaceTopography.html">SurfaceTopography package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="SurfaceTopography.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="SurfaceTopography.Generic.html">SurfaceTopography.Generic package</a></li>
<li class="toctree-l3"><a class="reference internal" href="SurfaceTopography.IO.html">SurfaceTopography.IO package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SurfaceTopography.Nonuniform package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.Autocorrelation">SurfaceTopography.Nonuniform.Autocorrelation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.Detrending">SurfaceTopography.Nonuniform.Detrending module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.PowerSpectrum">SurfaceTopography.Nonuniform.PowerSpectrum module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.ScalarParameters">SurfaceTopography.Nonuniform.ScalarParameters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.VariableBandwidth">SurfaceTopography.Nonuniform.VariableBandwidth module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.common">SurfaceTopography.Nonuniform.common module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="SurfaceTopography.Uniform.html">SurfaceTopography.Uniform package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.Converters">SurfaceTopography.Converters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.FFTTricks">SurfaceTopography.FFTTricks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.Generation">SurfaceTopography.Generation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.HeightContainer">SurfaceTopography.HeightContainer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.Interpolation">SurfaceTopography.Interpolation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.NonuniformLineScan">SurfaceTopography.NonuniformLineScan module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.Special">SurfaceTopography.Special module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.UniformLineScanAndTopography">SurfaceTopography.UniformLineScanAndTopography module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography.common">SurfaceTopography.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="SurfaceTopography.html#module-SurfaceTopography">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SurfaceTopography.IO.html">SurfaceTopography.IO package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SurfaceTopography.Nonuniform package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.Autocorrelation">SurfaceTopography.Nonuniform.Autocorrelation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.Detrending">SurfaceTopography.Nonuniform.Detrending module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.PowerSpectrum">SurfaceTopography.Nonuniform.PowerSpectrum module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.ScalarParameters">SurfaceTopography.Nonuniform.ScalarParameters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.VariableBandwidth">SurfaceTopography.Nonuniform.VariableBandwidth module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform.common">SurfaceTopography.Nonuniform.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SurfaceTopography.Nonuniform">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SurfaceTopography.Uniform.html">SurfaceTopography.Uniform package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SurfaceTopography</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="SurfaceTopography.html">SurfaceTopography package</a> &raquo;</li>
        
      <li>SurfaceTopography.Nonuniform package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/source/SurfaceTopography.Nonuniform.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="surfacetopography-nonuniform-package">
<h1>SurfaceTopography.Nonuniform package<a class="headerlink" href="#surfacetopography-nonuniform-package" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">Â¶</a></h2>
</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.Autocorrelation">
<span id="surfacetopography-nonuniform-autocorrelation-module"></span><h2>SurfaceTopography.Nonuniform.Autocorrelation module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.Autocorrelation" title="Permalink to this headline">Â¶</a></h2>
<p>Height-difference autocorrelation functions for nonuniform line scans</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.Autocorrelation.height_difference_autocorrelation">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.Autocorrelation.</span></code><code class="sig-name descname"><span class="pre">height_difference_autocorrelation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_scan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ninterpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/Autocorrelation.html#height_difference_autocorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.Autocorrelation.height_difference_autocorrelation" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the one-dimensional height-difference autocorrelation function
(ACF).</p>
<p>This function treats the nonuniform line scan as a piece-wise function of
straight lines between the data points. The ACF is computed exactly for
this piece-wise linear interpolation of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_scan</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â Container storing the nonuniform line scan.</p></li>
<li><p><strong>algorithm</strong> (<em>str</em>) â Algorithm to compute autocorrelation.
* âfftâ: Interpolates the nonuniform line scan on a grid and then uses
the FFT to compute the autocorrelation. Scales O(N log N)
* âbrute-forceâ: Brute-force computation using between line segements.
Scale O(N^2 M) where M is the number of distance point.
(Default: âfftâ)</p></li>
<li><p><strong>distances</strong> (<em>array_like</em>) â Array containing distances for which to compute the ACF. If no array
is given, the function will automatically construct an array with
equally spaced distances. Can be used only if âbrute-forceâ
algorithm is used. (Default: None)</p></li>
<li><p><strong>ninterpolate</strong> (<em>int</em>) â Number of grid points to put between closest points on surface. Only
used for âfftâ algorithm. (Default: 5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>distances</strong> (<em>array</em>) â Distances. (Units: length)</p></li>
<li><p><strong>A</strong> (<em>array</em>) â Autocorrelation function. (Units: length**2)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.Autocorrelation.height_height_autocorrelation">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.Autocorrelation.</span></code><code class="sig-name descname"><span class="pre">height_height_autocorrelation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_scan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/Autocorrelation.html#height_height_autocorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.Autocorrelation.height_height_autocorrelation" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the one-dimensional height-height autocorrelation function
(ACF).</p>
<p>This function treats the nonuniform line scan as a piece-wise function of
straight lines between the data points. The ACF is computed exactly for
this piece-wise linear interpolation of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_scan</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â Container storing the nonuniform line scan.</p></li>
<li><p><strong>r</strong> (<em>array_like</em>) â Array containing distances for which to compute the ACF. If no array
is given, the function will automatically construct an array with
equally spaced distances. (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>distances</strong> (<em>array</em>) â Distances. (Units: length)</p></li>
<li><p><strong>A</strong> (<em>array</em>) â Autocorrelation function. (Units: length**2)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.Detrending">
<span id="surfacetopography-nonuniform-detrending-module"></span><h2>SurfaceTopography.Nonuniform.Detrending module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.Detrending" title="Permalink to this headline">Â¶</a></h2>
<p>Helper functions to compute trends of surfaces</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.Detrending.polyfit">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.Detrending.</span></code><code class="sig-name descname"><span class="pre">polyfit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/Detrending.html#polyfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.Detrending.polyfit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the detrending plane that, if subtracted, minimizes the rms height
of the surface. The detrending plane is parameterized as a polynomial:</p>
<div class="math notranslate nohighlight">
\[p(x) = \sum_{k=0}^n a_k x^k\]</div>
<p>The values of <span class="math notranslate nohighlight">\(a_k\)</span> are returned by this function.</p>
<p>The rms height of the surface is given by (see <cite>rms_height</cite>)</p>
<div class="math notranslate nohighlight">
\[h_\text{rms}^2 = \frac{1}{3L} \sum_{i=0}^{N-2} \left( h_i^2 + h_{i+1}^2 + h_i h_{i+1} \right) \Delta x_i\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the total number of data points. Hence we need to solve the following minimization problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\{a_k\}} \left\{ \frac{1}{3L} \sum_{i=0}^{N-2} \left[ (h_i - p(x_i))^2 + (h_{i+1} - p(x_{i+1}))^2 + (h_i - p(x_i))(h_{i+1} - p(x_{i+1})) \right] \Delta x_i \right\}\]</div>
<p>This gives the system of linear equations (one for each <span class="math notranslate nohighlight">\(k\)</span>)</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{N-2} \left( \left[ 2h_i + h_{i+1} \right] x_i^k + \left[ 2h_{i+1} + h_i \right] x_{i+1}^k \right) \Delta x_i = \sum_{l=0}^n a_l \sum_{i=0}^{N-2} \left( 2x_i^{k+l} + 2x_{i+1}^{k+l} + x_i^k x_{i+1}^l + x_{i+1}^k x_i^l \right) \Delta x_i\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) â Array containing positions. This function assumes that this array is
sorted in ascending order.</p></li>
<li><p><strong>h</strong> (<em>array_like</em>) â Array containing heights.</p></li>
<li><p><strong>deg</strong> (<em>int</em>) â Degree of polynomial <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>a</strong> â Array with coefficients <span class="math notranslate nohighlight">\(a_k\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.PowerSpectrum">
<span id="surfacetopography-nonuniform-powerspectrum-module"></span><h2>SurfaceTopography.Nonuniform.PowerSpectrum module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.PowerSpectrum" title="Permalink to this headline">Â¶</a></h2>
<p>Power-spectral density for nonuniform topographies.</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.apply_window">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">apply_window</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#apply_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.apply_window" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.dsinc">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">dsinc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#dsinc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.dsinc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Derivative of the sinc function</p>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.ft_one_sided_triangle">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">ft_one_sided_triangle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#ft_one_sided_triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.ft_one_sided_triangle" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fourier transform of the one-sided triangle, <span class="math notranslate nohighlight">\(f(x) = x\)</span> for
<span class="math notranslate nohighlight">\(|x| &lt; 1/2\)</span>,</p>
<div class="math notranslate nohighlight">
\[\tilde{f}(q) = i [\cos(q/2)/q - 2\sin(q/2)/q^2] = d sinc(q/2)/dq\]</div>
<p>Returned value does not contain the factor of <span class="math notranslate nohighlight">\(i\)</span>, i.e. this
function is real-valued.</p>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.ft_rectangle">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">ft_rectangle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#ft_rectangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.ft_rectangle" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fourier transform of a rectangle, <span class="math notranslate nohighlight">\(f(x) = 1\)</span> for <span class="math notranslate nohighlight">\(|x| &lt; 1/2\)</span>,</p>
<div class="math notranslate nohighlight">
\[\tilde{f}(q) = 2\sin(q/2)/q = sinc(q/2)\]</div>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.power_spectrum">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">power_spectrum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">line_scan</span></em>, <em class="sig-param"><span class="pre">algorithm='fft'</span></em>, <em class="sig-param"><span class="pre">wavevectors=None</span></em>, <em class="sig-param"><span class="pre">ninterpolate=5</span></em>, <em class="sig-param"><span class="pre">short_cutoff=&lt;function</span> <span class="pre">mean&gt;</span></em>, <em class="sig-param"><span class="pre">window=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.power_spectrum" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute power-spectral density (PSD) for a nonuniform topography. The
topography is assumed to be given by a series of points connected by
straight lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_scan</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â Container storing the nonuniform line scan.</p></li>
<li><p><strong>algorithms</strong> (<em>str</em>) â Algorithm to compute autocorrelation.
* âfftâ: Interpolates the nonuniform line scan on a grid and then uses
the FFT to compute the autocorrelation. Scales O(N log N)
* âbrute-forceâ: Brute-force computation using between line segements.
Scale O(N^2 M) where M is the number of distance point.
(Default: âfftâ)</p></li>
<li><p><strong>wavevectors</strong> (<em>array</em><em>, </em><em>optional</em>) â Wavevectors at which to compute the PSD. If omitted, wavevectors are
equally spaced with a spacing that corresponds to <span class="math notranslate nohighlight">\(2\pi/\lambda\)</span>
where <span class="math notranslate nohighlight">\(\lambda\)</span> is the shortest distance between two points in
the <cite>x</cite>-array. (Default: None)</p></li>
<li><p><strong>ninterpolate</strong> (<em>int</em><em>, </em><em>optional</em>) â Number of grid points to put between closest points on surface. Only
used for âfftâ algorithm. (Default: 5)</p></li>
<li><p><strong>short_cutoff</strong> (<em>function</em><em>, </em><em>optional</em>) â Function that determines how the short cutoff for the returned PSD is
computed. If set to None, the full PSD of the interpolated data is
returned. If the user passes a function, that function is called with
an array that contains the distances between the points of the uniform
line scan. Pass <cite>np.max</cite>, <cite>np.mean</cite> or <cite>np.min</cite> to use the maximum,
mean or minimum of that distance as the cutoff.</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>optional</em>) â Name of the window function to apply before computing the PSD.
Presently only supports Hann window (âhannâ) or no window (None or
âNoneâ).
Default: no window for periodic Topographies, âhannâ window for
nonperiodic Topographies</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>q</strong> (<em>array</em>) â Wavevector array at which the PSD has been computed.</p></li>
<li><p><strong>C</strong> (<em>array</em>) â PSD values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.PowerSpectrum.sinc">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.PowerSpectrum.</span></code><code class="sig-name descname"><span class="pre">sinc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/PowerSpectrum.html#sinc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.PowerSpectrum.sinc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>sinc function</p>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.ScalarParameters">
<span id="surfacetopography-nonuniform-scalarparameters-module"></span><h2>SurfaceTopography.Nonuniform.ScalarParameters module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.ScalarParameters" title="Permalink to this headline">Â¶</a></h2>
<p>Functions computing scalar roughness parameters</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.ScalarParameters.rms_curvature">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.ScalarParameters.</span></code><code class="sig-name descname"><span class="pre">rms_curvature</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/ScalarParameters.html#rms_curvature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.ScalarParameters.rms_curvature" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes root-mean square slope fluctuation of the line scan:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topography</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â SurfaceTopography object containing height information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rms_slope</strong> â Root-mean square slope.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.ScalarParameters.rms_height">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.ScalarParameters.</span></code><code class="sig-name descname"><span class="pre">rms_height</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/ScalarParameters.html#rms_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.ScalarParameters.rms_height" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes root-mean square height fluctuation of the line scan:</p>
<div class="math notranslate nohighlight">
\[h_\text{rms} = \left[\frac{1}{L} \int_0^L dx\, h^2(x)\right]^{1/2}\]</div>
<p>Function approximates topography between data points as piece-wise linear.
The piece-wise linear section between point <span class="math notranslate nohighlight">\(i\)</span> and point
<span class="math notranslate nohighlight">\(i+1\)</span> contributes</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{\Delta x_i} dx\, \left( h_i + \frac{\Delta h_i}{\Delta x_i} x \right)^2 = \frac{1}{3} \left( h_i^2 + h_{i+1}^2 + h_i h_{i+1} \right) \Delta x_i\]</div>
<p>to the above integral, where <span class="math notranslate nohighlight">\(\Delta x_i=x_{i+1}-x_i\)</span> and <span class="math notranslate nohighlight">\(\Delta h_i=h_{i+1}-h_i\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topography</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â SurfaceTopography object containing height information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rms_height</strong> â Root-mean square height.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.ScalarParameters.rms_slope">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.ScalarParameters.</span></code><code class="sig-name descname"><span class="pre">rms_slope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/ScalarParameters.html#rms_slope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.ScalarParameters.rms_slope" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes root-mean square slope fluctuation of the line scan:</p>
<div class="math notranslate nohighlight">
\[h^\prime_\text{rms} = \left[ \frac{1}{L} \int_0^L dx\, \left(\frac{\partial h}{\partial x}\right)^2 \right]^{1/2}\]</div>
<p>Function approximates topography between data points as piece-wise linear.
The piece-wise linear section between point <span class="math notranslate nohighlight">\(i\)</span> and point
<span class="math notranslate nohighlight">\(i+1\)</span> contributes</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{\Delta x_i} dx\, \left( \frac{\Delta h_i}{\Delta x_i} \right)^2 = \frac{\Delta h_i^2}{\Delta x_i}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x_i=x_{i+1}-x_i\)</span> and <span class="math notranslate nohighlight">\(\Delta h_i=h_{i+1}-h_i\)</span> to the above integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topography</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â SurfaceTopography object containing height information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rms_slope</strong> â Root-mean square slope.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.VariableBandwidth">
<span id="surfacetopography-nonuniform-variablebandwidth-module"></span><h2>SurfaceTopography.Nonuniform.VariableBandwidth module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.VariableBandwidth" title="Permalink to this headline">Â¶</a></h2>
<p>Variable bandwidth analysis for nonuniform topographies</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.VariableBandwidth.checkerboard_detrend">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.VariableBandwidth.</span></code><code class="sig-name descname"><span class="pre">checkerboard_detrend</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_scan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdivisions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/VariableBandwidth.html#checkerboard_detrend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.VariableBandwidth.checkerboard_detrend" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Perform tilt correction (and substract mean value) in each individual
rectangle of a checkerboard decomposition of the surface. This is
identical to subdividing the surface into individual, nonoverlapping
rectangles and performing individual tilt corrections on them.</p>
<p>The main application of this function is to carry out a variable
bandwidth analysis of the surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_scan</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code>) â Container storing the uniform topography map</p></li>
<li><p><strong>subdivisions</strong> (<em>int</em>) â Number of subdivisions.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) â Tolerance for searching for existing data points at domain boundaries.
(Default: 1e-6)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subdivided_line_scans</strong> â List with new, subdivided and detrended line scans.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">NonuniformLineScan</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.VariableBandwidth.variable_bandwidth">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.VariableBandwidth.</span></code><code class="sig-name descname"><span class="pre">variable_bandwidth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_scan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_grid_pts_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/VariableBandwidth.html#variable_bandwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.VariableBandwidth.variable_bandwidth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Perform a variable bandwidth analysis by computing the mean
root-mean-square height within increasingly finer subdivisions of the
line scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_scan</strong> (obj:<cite>NonuniformLineScan</cite>) â Container storing the uniform topography map</p></li>
<li><p><strong>nb_grid_pts_cutoff</strong> (<em>int</em>) â Minimum number of data points to allow for subdivision. The analysis
will automatically analyze subdivision down to this nb_grid_pts.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>magnifications</strong> (<em>array</em>) â Array containing the magnifications.</p></li>
<li><p><strong>bandwidths</strong> (<em>array</em>) â Array containing the bandwidths, here the physical_sizes of the
subdivided topography.</p></li>
<li><p><strong>rms_heights</strong> (<em>array</em>) â Array containing the rms height corresponding to the respective
magnification.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform.common">
<span id="surfacetopography-nonuniform-common-module"></span><h2>SurfaceTopography.Nonuniform.common module<a class="headerlink" href="#module-SurfaceTopography.Nonuniform.common" title="Permalink to this headline">Â¶</a></h2>
<p>Bin for small common helper function and classes for nonuniform
topographies.</p>
<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.common.bandwidth">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.common.</span></code><code class="sig-name descname"><span class="pre">bandwidth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/common.html#bandwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.common.bandwidth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Computes lower and upper bound of bandwidth.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>A 2-tuple (lower_bound, upper_bound) where the elements are floats.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="SurfaceTopography.Nonuniform.common.derivative">
<code class="sig-prename descclassname"><span class="pre">SurfaceTopography.Nonuniform.common.</span></code><code class="sig-name descname"><span class="pre">derivative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topography</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SurfaceTopography/Nonuniform/common.html#derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SurfaceTopography.Nonuniform.common.derivative" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute derivative of nonuniform line-scan. Function assumes nonperiodic
topographies.</p>
<p>First derivative: Central differences.
Second derivative: Expand <span class="math notranslate nohighlight">\(h(x+\Delta x_+)\)</span> and <span class="math notranslate nohighlight">\((x-\Delta x_-)\)</span> up to second order in the grid
spacing <span class="math notranslate nohighlight">\(\Delta x_+\)</span> and <span class="math notranslate nohighlight">\(\Delta x_+\)</span>. Then
<span class="math notranslate nohighlight">\(\Delta x_- f(x+\Delta x_+) + \Delta x_+ f(x+\Delta x_-)\)</span> yields:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2h}{dx^2} \approx  = 2 \frac{\Delta x_-\left[f(x+\Delta x_+)-f(x)\right] + \Delta x+-\left[f(x+\Delta x_-)-f(x)\right]}{\Delta x_+\Delta x_-(\Delta x_++\Delta x_-)}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topography</strong> (<em>SurfaceTopography</em><em> or </em><a class="reference internal" href="SurfaceTopography.html#SurfaceTopography.UniformLineScanAndTopography.UniformLineScan" title="SurfaceTopography.UniformLineScanAndTopography.UniformLineScan"><em>UniformLineScan</em></a>) â SurfaceTopography object containing height information.</p></li>
<li><p><strong>n</strong> (<em>int</em>) â Number of times the derivative is taken.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>derivative</strong> â Array with derivative values. Length of array is reduced by <span class="math notranslate nohighlight">\(n\)</span> with
respect to the input array for the :math:<a href="#id1"><span class="problematic" id="id2">`</span></a>n`th derivative.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SurfaceTopography.Nonuniform">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-SurfaceTopography.Nonuniform" title="Permalink to this headline">Â¶</a></h2>
<p>Module containing all functions operating on uniform topographies</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="SurfaceTopography.Uniform.html" class="btn btn-neutral float-right" title="SurfaceTopography.Uniform package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="SurfaceTopography.IO.html" class="btn btn-neutral float-left" title="SurfaceTopography.IO package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2020 The Authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>